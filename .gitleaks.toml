title = "gitleaks config for wifisentry"

# Minimal rules to catch common secrets; expand as needed.
[[rules]]
id = "generic-api-key"
description = "Generic API key-ish"
regex = '''(?i)(api[_-]?key|secret|access[_-]?token|private[_-]?key)["'\s:=]{1,20}[A-Za-z0-9\-_=]{16,}'''
tags = ["apikey", "secret"]

[[rules]]
id = "aws-access-key-id"
description = "AWS Access Key ID"
regex = '''AKIA[0-9A-Z]{16}'''
tags = ["aws"]

[[rules]]
id = "mongodb-connection-string"
description = "Possible MongoDB connection string (SRV)"
regex = '''mongodb\+srv:\/\/[A-Za-z0-9_\-]+:[^\s@]+@[^\s]+'''
tags = ["mongodb", "db"]

[[rules]]
id = "google-api-key"
description = "Google API key pattern"
regex = '''AIza[0-9A-Za-z\-_]{35}'''
tags = ["google"]

[[allowlists]]
id = "documentation-files"
description = "Skip placeholder values in documentation and example files"
paths = [
    '''(?i)\.(md|txt|rst)$''',
    '''(?i)\.env\.example$''',
    '''(?i)\.env\.sample$''',
]
